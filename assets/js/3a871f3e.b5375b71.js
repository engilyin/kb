"use strict";(self.webpackChunkalex_ilin_kb=self.webpackChunkalex_ilin_kb||[]).push([[5885],{4582:(n,t,e)=>{e.r(t),e.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var r=e(4848),s=e(8453);const i={},a="Jenkins",o={id:"DevOps/jenkins",title:"Jenkins",description:"Turn off triggering on scan",source:"@site/docs/DevOps/jenkins.md",sourceDirName:"DevOps",slug:"/DevOps/jenkins",permalink:"/kb/DevOps/jenkins",draft:!1,unlisted:!1,editUrl:"https://github.com/engilyin/kb/docs/DevOps/jenkins.md",tags:[],version:"current",lastUpdatedAt:1739639427e3,frontMatter:{},sidebar:"defaultSidebar",previous:{title:"CI/CD",permalink:"/kb/DevOps/cicd"},next:{title:"Terraform",permalink:"/kb/DevOps/terraform"}},c={},l=[{value:"Turn off triggering on scan",id:"turn-off-triggering-on-scan",level:2},{value:"Call cf command",id:"call-cf-command",level:2},{value:"Touch the endpoint",id:"touch-the-endpoint",level:2}];function d(n){const t={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"jenkins",children:"Jenkins"})}),"\n",(0,r.jsx)(t.h2,{id:"turn-off-triggering-on-scan",children:"Turn off triggering on scan"}),"\n",(0,r.jsxs)(t.p,{children:["If you need to re-scan the pipeline to get new branches by default it would triggering all available branches which is not desirable.\r\nTo turn it off you need to add the property strategy ",(0,r.jsx)(t.code,{children:"Suppress automatic SCM triggering"})," and set:\r\n",(0,r.jsx)(t.code,{children:"For matching branches suppress builds triggering by indexing(continue to honor webhooks)"})]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"suppress-triggering",src:e(6298).A+"",width:"1249",height:"570"})}),"\n",(0,r.jsx)(t.h2,{id:"call-cf-command",children:"Call cf command"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-groovy",children:'\r\n#!groovy\r\n\r\n\r\n\r\ndef login(url, org, space){\r\n\r\nwithCredentials([usernamePassword(credentialsId: env.CredsToUse, usernameVariable: \'uName\', passwordVariable: \'password\')]) {\r\n\tCONNECT = sh (\r\n\t\t\t\tscript: "cf login -a ${url} -u \\"${uName}\\" -p \\"${password}\\" -o ${org} -s ${space}",\r\n\t\t\t\treturnStatus: true\r\n\t\t\t)\r\n\tsh """\r\n\t\t${env.PCF_COMMAND}\r\n\t\t"""\r\n}\r\n}\r\n\r\nansiColor(\'xterm\') {\r\n\r\nnode {\r\n\ttimeout(time: 30, unit: \'MINUTES\') {\r\n\r\n\t\tstage(\'Preparation\') {\r\n\t\t\tenv.PATH = "/usr/sbin:$env.PATH"\r\n\t\t\tenv.PATH = "/home/jenkins/bin:$env.PATH"\r\n\t\t\tenv.PATH = "/apps/home/builder/bin:$env.PATH"\r\n\r\n\t\t\tenv.LANG = "en_US.UTF-8"\r\n\t\t\tenv.LC_ALL = "en_US.UTF-8"\r\n\t\t\tenv.LANGUAGE = "en_US.UTF-8"\r\n\r\n\t\t\tdef regionUrlFragment;\r\n\t\t\tswitch(params.gcpRegion){\r\n\t\t\t\tcase "us-central-1":\r\n\t\t\t\t\tregionUrlFragment = \'usc1\'\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase "us-west-1":\r\n\t\t\t\t\tregionUrlFragment = \'usw1\'\r\n\t\t\t\t\tbreak\r\n\t\t\t}\r\n\t\t\tenv.PCF_API =  params.pcfApiEndpoint\r\n\t\t\tenv.PCF_ORG = params.pcfOrg\r\n\t\t\tenv.PCF_SPACE = params.pcfSpace\r\n\t\t\tenv.PCF_APP = params.pcfApp\r\n\t\t\tenv.PCF_COMMAND = params.pcfCommand\r\n\t\t}\r\n\t\t// stage(\'Approve Route Changes\'){\r\n\t\t//   input \'Please approve ClareityIAM Route management in production\'\r\n\t\t// }\r\n\t\tstage(\'Exec\')\r\n\t\t{\r\n\t\t\t\tlogin(env.PCF_API, env.PCF_ORG, env.PCF_SPACE)\r\n\r\n\t\t}\r\n\r\n\t}\r\n}\r\n}\r\n\n'})}),"\n",(0,r.jsx)(t.h2,{id:"touch-the-endpoint",children:"Touch the endpoint"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-groovy",children:"    stage('Stage 2') {\r\n      steps {\r\n        timeout(time: 1, unit: 'MINUTES') {\r\n          waitUntil {\r\n            script {\r\n              echo 'This stage should succeed immediately if google.com is up, otherwise jenkins will retry until 1min runs out.'\r\n              def status = sh script: 'wget -q https://google.com -O /dev/null', returnStatus: true\r\n              return (status == 0)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\n"})})]})}function p(n={}){const{wrapper:t}={...(0,s.R)(),...n.components};return t?(0,r.jsx)(t,{...n,children:(0,r.jsx)(d,{...n})}):d(n)}},6298:(n,t,e)=>{e.d(t,{A:()=>r});const r=e.p+"assets/images/suppress-triggering-265eceaeb3014f99b342bf2bcb5b2a8d.jpg"},8453:(n,t,e)=>{e.d(t,{R:()=>a,x:()=>o});var r=e(6540);const s={},i=r.createContext(s);function a(n){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof n?n(t):{...t,...n}}),[t,n])}function o(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:a(n.components),r.createElement(i.Provider,{value:t},n.children)}}}]);