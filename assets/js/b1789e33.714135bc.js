"use strict";(self.webpackChunkalex_ilin_kb=self.webpackChunkalex_ilin_kb||[]).push([[8037],{1895:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>d,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var i=r(4848),t=r(8453);const l={},o="How to replace the git authors",s={id:"Tools/git-author-replace",title:"How to replace the git authors",description:"There are two slightly different problems here:",source:"@site/docs/Tools/git-author-replace.md",sourceDirName:"Tools",slug:"/Tools/git-author-replace",permalink:"/kb/Tools/git-author-replace",draft:!1,unlisted:!1,editUrl:"https://github.com/engilyin/kb/docs/Tools/git-author-replace.md",tags:[],version:"current",lastUpdatedAt:1770362856e3,frontMatter:{},sidebar:"defaultSidebar",previous:{title:"Docker commands and useful stuff",permalink:"/kb/Tools/docker"},next:{title:"Git sheet sheet",permalink:"/kb/Tools/git"}},a={},c=[{value:"Big warning first (important)",id:"big-warning-first-important",level:2},{value:"Best tool: <code>git filter-repo</code> (recommended)",id:"best-tool-git-filter-repo-recommended",level:2},{value:"1. Install <code>git filter-repo</code>",id:"1-install-git-filter-repo",level:3},{value:"Option A \u2014 Replace <em>all</em> authors &amp; committers with one name/email",id:"option-a--replace-all-authors--committers-with-one-nameemail",level:2},{value:"Option B \u2014 Replace only specific wrong names/emails",id:"option-b--replace-only-specific-wrong-namesemails",level:2},{value:"Very important: clean the reflog",id:"very-important-clean-the-reflog",level:2},{value:"Verify that nothing leaks",id:"verify-that-nothing-leaks",level:2},{value:"Before uploading to GitHub / GitLab",id:"before-uploading-to-github--gitlab",level:2},{value:"One more subtle thing people forget",id:"one-more-subtle-thing-people-forget",level:2}];function h(e){const n={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"how-to-replace-the-git-authors",children:"How to replace the git authors"})}),"\n",(0,i.jsx)(n.p,{children:"There are two slightly different problems here:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Rewrite all commit authors/committers in history"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.strong,{children:"Make sure no old names/emails leak via reflog"})}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["I\u2019ll walk you through the ",(0,i.jsx)(n.em,{children:"clean, modern, safe"})," way."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"big-warning-first-important",children:"Big warning first (important)"}),"\n",(0,i.jsxs)(n.p,{children:["What you\u2019re about to do ",(0,i.jsx)(n.strong,{children:"rewrites Git history"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"That means:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Commit SHAs will change"}),"\n",(0,i.jsxs)(n.li,{children:["You must ",(0,i.jsx)(n.strong,{children:"force-push"})," after"]}),"\n",(0,i.jsx)(n.li,{children:"Anyone who already cloned the repo will need to re-clone"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Since you haven\u2019t uploaded it yet \u2014 this is the perfect moment."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"best-tool-git-filter-repo-recommended",children:["Best tool: ",(0,i.jsx)(n.code,{children:"git filter-repo"})," (recommended)"]}),"\n",(0,i.jsxs)(n.p,{children:["Forget ",(0,i.jsx)(n.code,{children:"git filter-branch"})," \u2014 it\u2019s slow and deprecated.\r\n",(0,i.jsx)(n.code,{children:"git filter-repo"})," is fast, safe, and officially recommended by Git."]}),"\n",(0,i.jsxs)(n.h3,{id:"1-install-git-filter-repo",children:["1. Install ",(0,i.jsx)(n.code,{children:"git filter-repo"})]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"macOS"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"brew install git-filter-repo\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Linux (pip)"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pip install git-filter-repo\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Windows"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"pip install git-filter-repo\n"})}),"\n",(0,i.jsx)(n.p,{children:"Verify:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git filter-repo --help\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsxs)(n.h2,{id:"option-a--replace-all-authors--committers-with-one-nameemail",children:["Option A \u2014 Replace ",(0,i.jsx)(n.em,{children:"all"})," authors & committers with one name/email"]}),"\n",(0,i.jsx)(n.p,{children:"This is the simplest and most brutal (and often what people want)."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'git filter-repo --commit-callback \'\r\ncommit.author_name = b"Your Name"\r\ncommit.author_email = b"your@email.com"\r\ncommit.committer_name = b"Your Name"\r\ncommit.committer_email = b"your@email.com"\r\n\'\n'})}),"\n",(0,i.jsx)(n.p,{children:"\u2705 Every commit\r\n\u2705 Every branch\r\n\u2705 Every tag"}),"\n",(0,i.jsxs)(n.p,{children:["After this, ",(0,i.jsx)(n.strong,{children:"no old names/emails remain in commit history"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"option-b--replace-only-specific-wrong-namesemails",children:"Option B \u2014 Replace only specific wrong names/emails"}),"\n",(0,i.jsx)(n.p,{children:"If you want to keep correct authors and only fix mistakes:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git filter-repo --mailmap <<'EOF'\r\nWrong Name <wrong@email.com>  Correct Name <correct@email.com>\r\nAnother Name <another@bad.com> Correct Name <correct@email.com>\r\nEOF\n"})}),"\n",(0,i.jsx)(n.p,{children:"This:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Rewrites history"}),"\n",(0,i.jsx)(n.li,{children:"Fixes only listed identities"}),"\n",(0,i.jsx)(n.li,{children:"Leaves others untouched"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"very-important-clean-the-reflog",children:"Very important: clean the reflog"}),"\n",(0,i.jsxs)(n.p,{children:["Even after rewriting commits, ",(0,i.jsx)(n.strong,{children:"reflog can still contain old identities locally"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Run these commands ",(0,i.jsx)(n.strong,{children:"after"})," ",(0,i.jsx)(n.code,{children:"filter-repo"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git reflog expire --expire=now --all\r\ngit gc --prune=now --aggressive\n"})}),"\n",(0,i.jsx)(n.p,{children:"This removes:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Old commit references"}),"\n",(0,i.jsx)(n.li,{children:"Reflog entries pointing to rewritten history"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"verify-that-nothing-leaks",children:"Verify that nothing leaks"}),"\n",(0,i.jsx)(n.p,{children:"Check commit history:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git log --format='%an <%ae>' | sort | uniq\n"})}),"\n",(0,i.jsx)(n.p,{children:"Check committers too:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git log --format='%cn <%ce>' | sort | uniq\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You should see ",(0,i.jsx)(n.strong,{children:"only"})," the names/emails you expect."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"before-uploading-to-github--gitlab",children:"Before uploading to GitHub / GitLab"}),"\n",(0,i.jsx)(n.p,{children:"When you push:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git push --force --all\r\ngit push --force --tags\n"})}),"\n",(0,i.jsx)(n.p,{children:"(Force is required because history changed.)"}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"one-more-subtle-thing-people-forget",children:"One more subtle thing people forget"}),"\n",(0,i.jsxs)(n.p,{children:["Git also stores identity in ",(0,i.jsx)(n.strong,{children:"local config"}),", not history:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git config --global user.name\r\ngit config --global user.email\n"})}),"\n",(0,i.jsx)(n.p,{children:"Set them correctly so you don\u2019t repeat the mistake:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'git config --global user.name "Your Name"\r\ngit config --global user.email "your@email.com"\n'})})]})}function d(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>s});var i=r(6540);const t={},l=i.createContext(t);function o(e){const n=i.useContext(l);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(l.Provider,{value:n},e.children)}}}]);