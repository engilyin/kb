<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-Job/TechInterview/Java/core/garbage-collection" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">garbage-collection | Alex Ilin Knowledge Base</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://engilyin.github.com/kb/Job/TechInterview/Java/core/garbage-collection"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="garbage-collection | Alex Ilin Knowledge Base"><meta data-rh="true" name="description" content="Garbage Collection"><meta data-rh="true" property="og:description" content="Garbage Collection"><link data-rh="true" rel="icon" href="/kb/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://engilyin.github.com/kb/Job/TechInterview/Java/core/garbage-collection"><link data-rh="true" rel="alternate" href="https://engilyin.github.com/kb/Job/TechInterview/Java/core/garbage-collection" hreflang="en"><link data-rh="true" rel="alternate" href="https://engilyin.github.com/kb/Job/TechInterview/Java/core/garbage-collection" hreflang="x-default"><link rel="stylesheet" href="/kb/assets/css/styles.c22c4916.css">
<script src="/kb/assets/js/runtime~main.e21ed650.js" defer="defer"></script>
<script src="/kb/assets/js/main.f61584fd.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard" data-theme="light">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/kb/"><div class="navbar__logo"><img src="/kb/img/logo.jpg" alt="Alex Ilin KB Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/kb/img/logo.jpg" alt="Alex Ilin KB Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Alex Ilin Knowledge Base</b></a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="dsla-search-wrapper"><div class="dsla-search-field" data-tags="default,docs-default-current"></div></div></div><a href="https://github.com/engilyin/kb" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/kb/">Alex Ilin Knowledge Base</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kb/Cloud/AWS/">Cloud</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kb/category/databases">Databases</a><button aria-label="Expand sidebar category &#x27;Databases&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kb/category/devops">DevOps</a><button aria-label="Expand sidebar category &#x27;DevOps&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kb/category/development">Development</a><button aria-label="Expand sidebar category &#x27;Development&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/kb/category/job">Job</a><button aria-label="Collapse sidebar category &#x27;Job&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/kb/category/interview">Interview</a><button aria-label="Collapse sidebar category &#x27;Interview&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/kb/Job/TechInterview/Java/">Java Tech Interview</a><button aria-label="Collapse sidebar category &#x27;Java Tech Interview&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/kb/Job/TechInterview/Java/core/collections">core</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/Java/core/collections">collections</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/Java/core/concurrency">concurrency</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/Java/core/core-java">core-java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/kb/Job/TechInterview/Java/core/garbage-collection">garbage-collection</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/Java/core/java-8">java-8</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/Java/core/java-memory-model">java-memory-model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/Java/core/jvm-internals">jvm-internals</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/kb/Job/TechInterview/Java/design/approach">design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/kb/Job/TechInterview/Java/opinion/myanswers">opinion</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/kb/Job/TechInterview/Java/problem-solving/common-coding-problems">problem-solving</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/kb/Job/TechInterview/Java/related/sql">related</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/kb/Job/TechInterview/Java/spring/aop">spring</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/db-tech-interview">Tech Interview DB</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/kb/Job/TechInterview/devops-tech-interview">Tech Interview DevOps</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/kb/Network/networking">Network</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kb/category/sre">SRE</a><button aria-label="Expand sidebar category &#x27;SRE&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/kb/category/tools">Tools</a><button aria-label="Expand sidebar category &#x27;Tools&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/kb/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kb/category/job"><span itemprop="name">Job</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kb/category/interview"><span itemprop="name">Interview</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/kb/Job/TechInterview/Java/"><span itemprop="name">Java Tech Interview</span></a><meta itemprop="position" content="3"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">core</span><meta itemprop="position" content="4"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">garbage-collection</span><meta itemprop="position" content="5"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>garbage-collection</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="garbage-collection">Garbage Collection<a href="#garbage-collection" class="hash-link" aria-label="Direct link to Garbage Collection" title="Direct link to Garbage Collection">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="resources">Resources<a href="#resources" class="hash-link" aria-label="Direct link to Resources" title="Direct link to Resources">​</a></h3>
<ul>
<li><a href="http://mechanical-sympathy.blogspot.in/2013/07/java-garbage-collection-distilled.html" target="_blank" rel="noopener noreferrer">GC Overview by Martin Thompson</a> - Highly recommended</li>
<li><a href="https://plumbr.eu/handbook/garbage-collection-algorithms-implementations" target="_blank" rel="noopener noreferrer">Detailed overview of all GC collectors</a></li>
<li><a href="https://blog.plan99.net/modern-garbage-collection-911ef4f8bd8e#.qcnv033nr" target="_blank" rel="noopener noreferrer">Modern Garbage Collection (GC Trade-offs)</a></li>
<li><a href="https://www.youtube.com/watch?v=Gee7QfoY8ys" target="_blank" rel="noopener noreferrer">Internals of G1 collector</a></li>
<li><a href="https://www.youtube.com/watch?v=N0JTvyCxiv8" target="_blank" rel="noopener noreferrer">Overview of Shenondoah collector</a></li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="quick-glance">Quick Glance<a href="#quick-glance" class="hash-link" aria-label="Direct link to Quick Glance" title="Direct link to Quick Glance">​</a></h3>
<table><thead><tr><th>Collector</th><th>Pros</th><th>Cons</th><th>Use-Case</th></tr></thead><tbody><tr><td>Serial</td><td>Fast promotion and minor GC (Bump the pointer)<br>Smallest footprint</td><td>Single Thread</td><td>Limited memory (embedded).<br> CPU running lot of JVMs (helps limit GC impact other JVMs)</td></tr><tr><td>Parallel</td><td>Fast promotion and minor GC (Bump the pointer)<br>Higher Throughput (doesn&#x27;t run with application)</td><td>High worst-case latency (due to compaction)</td><td>Batch applications</td></tr><tr><td>CMS</td><td>Low STW pauses (Concurrent mark).<br>Low worst case latency.</td><td>Slow promotion &amp; Minor GC (free lists)<br>Reduced throughput<br>Higher footprint.</td><td>General applications</td></tr><tr><td>G1</td><td>Incremental collection<br>Lower worst case latency<br>Relatively faster promotion (no free lists) <br>More throughput (no compaction)</td><td>Higher footprint</td><td>Predictable/Target latency applications.<br>Large heaps</td></tr><tr><td>Shenondoah</td><td>Lower latency</td><td>Higher footprint</td><td>Even lower latency<br> Much Larger heaps</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="concepts">Concepts<a href="#concepts" class="hash-link" aria-label="Direct link to Concepts" title="Direct link to Concepts">​</a></h3>
<ul>
<li>Throughput - Percentage of time application runs vs GC</li>
<li>Latency - Amount of pause time for application waiting for GC to complete</li>
<li>Memory - Amount of memory used to store the objects aka heap (along with GC related data structures)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="trade-offs">Trade offs<a href="#trade-offs" class="hash-link" aria-label="Direct link to Trade offs" title="Direct link to Trade offs">​</a></h3>
<ul>
<li>If memory is less, throughput is less, because JVM has to constantly do GC</li>
<li>If memory is more, latency is high, because JVM has to sweep huge space to do GC</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-cases">Use cases<a href="#use-cases" class="hash-link" aria-label="Direct link to Use cases" title="Direct link to Use cases">​</a></h3>
<ul>
<li>For trading applications, deterministic (more average) latency is better than sudden spikes (increased worst case latency).</li>
<li>For batch applications, it might be ok for increase worst case latency, if it helps gain more throughput</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="tweaks">Tweaks<a href="#tweaks" class="hash-link" aria-label="Direct link to Tweaks" title="Direct link to Tweaks">​</a></h3>
<ul>
<li>To large extent, more memory for GC helps in increasing throughput</li>
<li>Worst case latency can be reduced by keeping heap size small (&amp; live set small)</li>
<li>Frequency of GC can be reduced by managing heap &amp; generation sizes</li>
<li>Frequency of large pauses can be reduced by running GC with application, sometimes at cost of throughput (because it runs longer due to 2 STW pauses, and one thread is used by GC which could&#x27;ve been used by application).</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="object-lifetimes">Object lifetimes<a href="#object-lifetimes" class="hash-link" aria-label="Direct link to Object lifetimes" title="Direct link to Object lifetimes">​</a></h3>
<ul>
<li>Infant mortality / Weak generational hypothesis - Most objects die young.</li>
<li>Thus, generational GC algorithms provide magnitude-of-order better throughput.</li>
<li>How? Region with newly allocated object is sparse for live objects, they can be quickly copied over and region can be wiped entirely.</li>
<li>If application keeps allocating objects that live too long. The generational split becomes useless, and GC takes long time. Because old generation is too big (&amp; not so sparse).</li>
<li>Lifetime of object is recorded by JVM as number of GC cycles survived.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="stop-the-world-events">Stop the World Events<a href="#stop-the-world-events" class="hash-link" aria-label="Direct link to Stop the World Events" title="Direct link to Stop the World Events">​</a></h3>
<ul>
<li>Collectors need application execution to stop for practical reasons.</li>
<li>Threads are signalled to stop. Threads stop when they reach safe points of execution.</li>
<li>If thread is busy (copying large array, cloning a large object), it might be few milliseconds till this point.</li>
<li>‑XX:+PrintGCApplicationStoppedTime this flag is used to print the time taken to reach safe point.</li>
<li>Once GC STW event is over, all threads are free to resume. An application with large number of threads can suffer scheduling pressure. It might be more efficient to use different collector then.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="heap-organization-in-hotspot">Heap organization in HotSpot<a href="#heap-organization-in-hotspot" class="hash-link" aria-label="Direct link to Heap organization in HotSpot" title="Direct link to Heap organization in HotSpot">​</a></h3>
<ul>
<li>Heap is split in Young and Old (Tenured) generation</li>
<li>Young generation is split in - Eden and Survivor (1,2) spaces</li>
<li>PermGen is used to store effectively immortal objects (Classes, static strings etc).</li>
<li>In Java 7, interned Strings were removed from PermGen.</li>
<li>In Java 8, PermGen space itself is replaced by MetaSpace.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="object-allocation">Object allocation<a href="#object-allocation" class="hash-link" aria-label="Direct link to Object allocation" title="Direct link to Object allocation">​</a></h3>
<ul>
<li>Each thread is assigned TLAB (Thread Local Allocation Buffer) to allocate new objects.</li>
<li>Since there is no conflict between threads, object allocation is just a bump-the-pointer, and is faster than MALLOC in C. Roughly 10 machine instructions.</li>
<li>When TLAB is exhausted new TLAB is requested from Eden. If Eden is filled, Minor GC is triggered.</li>
<li>If a large object (size greater than TLAB) is to be allocated, it is done directly in Eden or Old Generation.</li>
<li>-XX<!-- -->:PretenureSizeThreshold<!-- -->=&lt;n&gt; If this is smaller than TLAB, then small objects are still allocated in TLAB itself, not in Old generation.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="minor-collection">Minor Collection<a href="#minor-collection" class="hash-link" aria-label="Direct link to Minor Collection" title="Direct link to Minor Collection">​</a></h3>
<ul>
<li>Called when Eden is full.</li>
<li>Live objects are moved to one of the survivor spaces.</li>
<li>If survivor space is full or object has live too long (XX<!-- -->:MaxTenuringThreshold<!-- -->=&lt;n&gt;) it is moved to tenured generation.</li>
<li>Major cost of minor collection is in copying live objects to survivor / old generation. Thus, overall cost depends on number of objects to be copied not the size of Eden.</li>
<li>Thus, if new generation size is doubled, total minor GC time is almost halved (thus increasing the throughput). Assuming number of live objects remain constant.</li>
<li>Minor collections are STW events. This is becoming an issue as heaps are getting larger, with more and more live objects.</li>
<li>This algorithm is called mark-and-copy</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="marking-live-objects">Marking Live Objects<a href="#marking-live-objects" class="hash-link" aria-label="Direct link to Marking Live Objects" title="Direct link to Marking Live Objects">​</a></h3>
<ul>
<li>All objects in graph starting from GC Roots</li>
<li>GC roots = references from application, JVM internal static fields and thread stack-frames</li>
<li>References from old generation to young generation (aka cross generational references) are also tracked</li>
<li>Card tables are used for this. Card tables are array of bytes. Each byte represents 512 bytes of old gen. If byte is set, it means corresponding 512 bytes of old gen has reference to young gen objects.</li>
<li>During minor collection, all such cards are checked, then all those 512 byte regions are checked for references. Thus, minor collection latency also depends on number of old gen to young gen references.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="major-collection">Major Collection<a href="#major-collection" class="hash-link" aria-label="Direct link to Major Collection" title="Direct link to Major Collection">​</a></h3>
<ul>
<li>JVM tries to predict, set % threshold and start collection when threshold is passed.</li>
<li>When object cannot be promoted from younger gen due to lack of space in old gen, then FullGC is triggered.</li>
<li>FullGC = minor collection + major collection (including compaction).</li>
<li>FullGC is also triggered when old gen size needs to be changed. This can be avoided by keeping Xms same as Xmx</li>
<li>Compaction is likely to cause largest STW</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="serial-collector">Serial Collector<a href="#serial-collector" class="hash-link" aria-label="Direct link to Serial Collector" title="Direct link to Serial Collector">​</a></h3>
<ul>
<li>Smallest footprint of any collectors</li>
<li>Uses single thread for both minor and major collections.</li>
<li>Objects in old gen are allocated with simple bump the pointer technique</li>
<li>Major GC is triggered when old gen is full</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="parallel-collector">Parallel Collector<a href="#parallel-collector" class="hash-link" aria-label="Direct link to Parallel Collector" title="Direct link to Parallel Collector">​</a></h3>
<ul>
<li>Parallel Collector - Multiple threads for minor GC, and single thread for major GC.</li>
<li>Parallel Old Collector - Multiple threads for both minor and major GC. Default since Java 7u4</li>
<li>Doesn&#x27;t run with the application.</li>
<li>Greatest throughput in multi-processor systems. Great for batch applications.</li>
<li>Cost of Old GC, is proportional to number of objects, thus doubling old gen size can help in increasing throughput (larger but fewer GC pauses).</li>
<li>Minor GCs are fast because promotion in old gen is just bump-the-pointer.</li>
<li>Major GC takes 1-5 seconds per live data</li>
<li>Allows for -XX:+UseNUMA to allocate Eden space per CPU socket (can increase performance)</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="concurrent-mark-and-sweep">Concurrent Mark and Sweep<a href="#concurrent-mark-and-sweep" class="hash-link" aria-label="Direct link to Concurrent Mark and Sweep" title="Direct link to Concurrent Mark and Sweep">​</a></h3>
<ul>
<li>Parallel (multiple threads) for Minor GC</li>
<li>Runs with application to try to avoid promotion failure. Promotion failure causes FullGC.</li>
<li>CMS =<!-- -->
<ul>
<li>Initial mark = Find GC roots</li>
<li>Concurrent mark = mark all objects from GC root</li>
<li>Concurrent pre-clean = check for updated object references &amp; promoted objects during mark (Card Marking technique)</li>
<li>Re-mark = mark all objects in pre-clean</li>
<li>Concurrent sweep = reclaim memory and update free-lists</li>
<li>Concurrent reset = reset data structures used</li>
</ul>
</li>
<li>During concurrent sweep, promotions can occur, but those are in free-lists which are not being swept anyways. So there is not conflict.</li>
<li>Minor GCs can keep happening while Major GC is happening! Thus the pre-clean phase.</li>
<li>Slower minor GCs during promotion. Cost of promotion is higher since, free-lists have to be checked for suitable sized hole.</li>
<li>CMS is not compacting collector, so when object promotion fails due to not having enough space in free-lists. CMS is followed by compaction. This latency can be worse than Parallel Old collector.</li>
<li>Decreases latency, but less throughput. Avg ¼ GC threads per 1 CPU core.</li>
<li>Throughput reduction between 20-40% compared to parallel collector (&amp; based on object allocation rate).</li>
<li>20% more space required.</li>
<li>&quot;Concurrent mode failure&quot; - When CMS cannot keep up with high promotion rates. Increasing heap makes it even worse, because sweeping will take even more time.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="g1-garbage-first"><a href="https://www.youtube.com/watch?v=Gee7QfoY8ys" target="_blank" rel="noopener noreferrer">G1 Garbage First</a><a href="#g1-garbage-first" class="hash-link" aria-label="Direct link to g1-garbage-first" title="Direct link to g1-garbage-first">​</a></h3>
<ul>
<li>Soft real-time targets. Spend x milliseconds in GC out of y milliseconds.</li>
<li>Divides heap into large regions ~2048</li>
<li>Categorizes regions in Eden, Survivor and Old gen spaces.</li>
<li>Minor GC is triggered, when all Eden regions are filled.</li>
<li>Selects closest set of nearly free regions (called Collection Set), to move live objects, essentially causing regions to be empty. Thus it approaches problem incrementally, as opposed to CMS which has to perform on entire Old gen.</li>
<li>Objects larger than 50% of region are saved in &quot;humungous region&quot;</li>
<li>Regions can have objects being referenced from multiple other regions. These are tracked using Reference Sets. Thus, while moving live objects, all the references to such objects need to be updated. Thus, even minor collections can potentially be longer than Parallel or CMS collector.</li>
<li>It avoids collecting (moving) from regions which have high references. Unless it has no other option.</li>
<li>G1 is target driven on latency –XX<!-- -->:MaxGCPauseMillis<!-- -->=&lt;n&gt;, default value = 200ms</li>
<li>G1 reduces worst case latency, at the cost of higher average latency.</li>
<li>Compactions are piggybacked on Young Gen GC.</li>
<li>During reference changes, cards (arrays pointing to 512 bytes of a region) are marked dirty, and source-target details are placed in dirty card queue. Depending on number of elements in queue (white, green, yellow, red) G1 starts threads which take information from queue and write to Remembered Set. More the queue is full, more G1 threads try to drain it. Remembered set will be heavily contended if all threads directly write to RS, its better if only specific G1 threads (1 or 2) write to them.</li>
<li>If Young GC cannot finish within maxTargetPauseTime, then # of Eden regions are reduced to finish within the target.</li>
<li>Old GC is triggered when total 45% is full, and is checked just after Young GC or after allocating humongous object.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="shenandoah"><a href="https://www.youtube.com/watch?v=N0JTvyCxiv8" target="_blank" rel="noopener noreferrer">Shenandoah</a><a href="#shenandoah" class="hash-link" aria-label="Direct link to shenandoah" title="Direct link to shenandoah">​</a></h3>
<ul>
<li>10% hit in throughput, but 7x more responsive.</li>
<li>Avg Pause 5x better - 60ms (vs 600ms in G1).</li>
<li>Max Pause 3x better - 500ms (vs 1700ms). Lot of headroom.</li>
<li>Target - 10ms average, and max 100ms.</li>
<li>Region based like G1 (remembered sets, collection sets)</li>
<li>Concurrent mark and sweep same as CMS and G1</li>
<li>It does compaction though + concurrently while threads are running</li>
<li>Trick is to create indirection pointer to objects, and after copying live objects, atomically update the indirection pointer to copied version of the objects.</li>
<li>Not Generational. Claim is, Weak Generational Hypothesis is no longer applicable.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="other-pauses-not-related-to-gc">Other pauses not related to GC<a href="#other-pauses-not-related-to-gc" class="hash-link" aria-label="Direct link to Other pauses not related to GC" title="Direct link to Other pauses not related to GC">​</a></h3>
<ul>
<li>Networking, Disk read/writes, Waiting for DBs</li>
<li>OS interrupts (~5ms), this doesn&#x27;t show up in logs</li>
<li>Lock contention</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/engilyin/kb/docs/Job/TechInterview/Java/core/garbage-collection.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2024-10-03T16:28:54.000Z" itemprop="dateModified">Oct 3, 2024</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/kb/Job/TechInterview/Java/core/core-java"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">core-java</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/kb/Job/TechInterview/Java/core/java-8"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">java-8</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#garbage-collection" class="table-of-contents__link toc-highlight">Garbage Collection</a><ul><li><a href="#resources" class="table-of-contents__link toc-highlight">Resources</a></li><li><a href="#quick-glance" class="table-of-contents__link toc-highlight">Quick Glance</a></li><li><a href="#concepts" class="table-of-contents__link toc-highlight">Concepts</a></li><li><a href="#trade-offs" class="table-of-contents__link toc-highlight">Trade offs</a></li><li><a href="#use-cases" class="table-of-contents__link toc-highlight">Use cases</a></li><li><a href="#tweaks" class="table-of-contents__link toc-highlight">Tweaks</a></li><li><a href="#object-lifetimes" class="table-of-contents__link toc-highlight">Object lifetimes</a></li><li><a href="#stop-the-world-events" class="table-of-contents__link toc-highlight">Stop the World Events</a></li><li><a href="#heap-organization-in-hotspot" class="table-of-contents__link toc-highlight">Heap organization in HotSpot</a></li><li><a href="#object-allocation" class="table-of-contents__link toc-highlight">Object allocation</a></li><li><a href="#minor-collection" class="table-of-contents__link toc-highlight">Minor Collection</a></li><li><a href="#marking-live-objects" class="table-of-contents__link toc-highlight">Marking Live Objects</a></li><li><a href="#major-collection" class="table-of-contents__link toc-highlight">Major Collection</a></li><li><a href="#serial-collector" class="table-of-contents__link toc-highlight">Serial Collector</a></li><li><a href="#parallel-collector" class="table-of-contents__link toc-highlight">Parallel Collector</a></li><li><a href="#concurrent-mark-and-sweep" class="table-of-contents__link toc-highlight">Concurrent Mark and Sweep</a></li><li><a href="#g1-garbage-first" class="table-of-contents__link toc-highlight">G1 Garbage First</a></li><li><a href="#shenandoah" class="table-of-contents__link toc-highlight">Shenandoah</a></li><li><a href="#other-pauses-not-related-to-gc" class="table-of-contents__link toc-highlight">Other pauses not related to GC</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Alex Ilin. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>